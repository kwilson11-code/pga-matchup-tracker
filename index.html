<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PGA Matchup Tracker - Live Tee Times & Scores</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; }
        h1 { text-align: center; color: #004d00; }
        #search { width: 100%; max-width: 500px; padding: 12px; margin: 20px auto; display: block; font-size: 16px; border: 1px solid #ccc; border-radius: 4px; }
        #status { text-align: center; font-size: 18px; margin: 20px; font-weight: bold; }
        .error { color: red; }
        .group { background: white; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 15px auto; max-width: 600px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .favorite { border-color: #ffcc00; background: #fffef0; }
        .star { cursor: pointer; font-size: 28px; float: right; color: #ffcc00; }
        .player { margin: 10px 0; font-size: 16px; }
        .winner { font-weight: bold; color: #006400; background: #e0ffe0; padding: 4px; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>PGA 3-Ball/2-Ball Matchup Tracker</h1>
    <input type="text" id="search" placeholder="Search player name or tee time (e.g., Scheffler, 11:45)...">
    <div id="status">Loading live PGA data for today's tournament...</div>
    <div id="favorites"></div>
    <div id="all-groups"></div>

    <script>
        const API_BASE = 'https://golf-leaderboard-data.p.rapidapi.com';
const API_KEY = '400bc5a764msh71553cc3da7c3e9p1e506ejsn6bff53036f07';
const YEAR = '2026';

let allGroups = [];
let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');

async function apiCall(endpoint) {
    console.log(`Fetching: ${endpoint}`);
    const response = await fetch(API_BASE + endpoint, {
        headers: {
            'x-rapidapi-key': API_KEY,
            'x-rapidapi-host': 'golf-leaderboard-data.p.rapidapi.com'
        }
    });
    if (!response.ok) {
        const errText = await response.text();
        console.error(`Fetch failed for ${endpoint}: ${response.status} ${errText}`);
        throw new Error(`API error: ${response.status} for ${endpoint}`);
    }
    const data = await response.json();
    console.log(`Response from ${endpoint}:`, data);
    return data;
}

async function getCurrentTournamentId() {
    const status = document.getElementById('status');
    status.textContent = 'Testing hardcoded tournament ID for current event...';
    // Hardcoded for AT&T Pebble Beach Pro-Am 2026 (from PGA Tour URL pattern: R2026005; test alternatives if fails)
    const testTid = 'R2026005'; // Try this first; alternatives below if 404
    // '220' or '29629116' or '005' or '296' – change and re-test
    console.log('Using test tournament ID:', testTid);
    return testTid;
}

async function loadData() {
    const status = document.getElementById('status');
    status.textContent = 'Fetching leaderboard...';
    try {
        const tid = await getCurrentTournamentId();
        const data = await apiCall(`/leaderboard/${tid}/${YEAR}`);
        const players = data.leaderboard || data.players || data.results || data || [];
        console.log('Players array length:', players.length);
        if (players.length > 0) console.log('First player sample:', players[0]);

        if (players.length === 0) throw new Error('No players in leaderboard response');

        // Your grouping/render logic here (copy from previous if needed)
        // Example placeholder – adjust fields based on console sample
        allGroups = players.reduce((groups, player) => {
            const tee = player.tee_time || player.teeTime || 'Unknown';
            if (!groups[tee]) groups[tee] = [];
            groups[tee].push(player);
            return groups;
        }, {});
        allGroups = Object.entries(allGroups).map(([teeTime, players]) => ({teeTime, players}));

        // Render favorites
        const favContainer = document.getElementById('favorites');
        favContainer.innerHTML = '<h2>Favorites</h2>';
        // ... add render code for favorites and all-groups similarly

        status.textContent = 'Data loaded! ' + players.length + ' players found.';
    } catch (err) {
        console.error('Load error:', err);
        status.textContent = `Error: ${err.message}. Check console for details (F12).`;
        status.style.color = 'red';
    }
}

document.getElementById('search').addEventListener('input', loadData);
loadData();
setInterval(loadData, 60000);
    </script>
</body>
</html>
